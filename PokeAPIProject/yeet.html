<!DOCTYPE html>
<html lang="en">
<head>
    <title>PokeDex using PokeAPI</title>
    <!--imports for corresponding CSS and JS files + axios import for JS functionality-->
    <link rel="stylesheet" href="PokeAPICSS.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="PokeAPIFunctions.js"></script>
</head>
<title>Pokedex</title>
<body onload="getDefaultPokeData()">
    <div class="container">
        <div id="head">
            <h1>PokeDex</h1>
        </div>
        <!--table displaying generation data for pokemon games-->
<div id="table">
    <table>
        <tr>
            <td>Generation Number</td>
            <td>Game Titles</td>
            <td>Gen Limits (IDs)</td>
        </tr>
        <tr>
            <td>1 - First Gen</td>
            <td>Pokemon Red, Pokemon Blue, Pokemon Green, Pokemon Yellow</td>
            <td>1 - 151</td>
        </tr>
        <tr>
            <td>2 - Second Gen</td>
            <td>Pokemon Gold and Silver, Pokemon Crystal</td>
            <td>152 - 251</td>
        </tr>
        <tr>
            <td>3 - Third Gen</td>
            <td>Pokemon Ruby and Sappire, Pokemon FireRed and LeafGreen, Pokemon Emerald</td>
            <td>252 - 386</td>
        </tr>
        <tr>
            <td>4 - Fourth Gen</td>
            <td>Pokemon Diamond and Pearl, Pokemon Platinum, Pokemon HeartGold and SoulSilver</td>
            <td>387 - 493</td>
        </tr>
        <tr>
            <td>5 - Fifth Gen</td>
            <td>Pokemon Black and White, Pokemon Black 2 and White 2</td>
            <td>494 - 649</td>
        </tr>
        <tr>
            <td>6 - Sixth Gen</td>
            <td>Pokemon X and Y, Pokemon Omega Ruby and Alpha Sapphire</td>
            <td>650 - 721</td>
        </tr>
    </table>
</div>
<div id="form">

    <!--form for getting generation selection and desired pokemon from user-->
    <form id="pokeform">
        <br>

        <label for="gen">Please select a generation: </label>
        <select name="gen" id="gen">
            <option value="none" selected>--Please Select--</option>
            <option value="gen1">Gen 1</option>
            <option value="gen2">Gen 2</option>
            <option value="gen3">Gen 3</option>
            <option value="gen4">Gen 4</option>
            <option value="gen5">Gen 5</option>
            <option value="gen6">Gen 6</option>
        </select>
        <br>
        <br>
        <br>
        <label for="pokemon">Enter your desired Pokemon below: </label>
        <br>
        <input type="text" id="pokemon" name="pokemon" size="35" placeholder="ex. 1 or bulbasaur">
        <br>

    </form>
</div>
<div id="buttons">
    <input type="button" onclick="getPokeData()" value="Pokemon Search!">
    <!-- <a href="https://pokeapi.co/docs/v2" target="_blank">PokeAPIv2 Link</a>
    <br>
    <a href="PokeBattleSim.html" target="_blank">PokeMon Battle Simulator!</a> -->
</div>
<!--main output div for holding the output for pokemon data-->
<div id="outputDiv"class="output-container"> 
    <div id="outName" class="output"></div>
    <div id="outID" class="output"></div>
    <div id="outType" class="output"></div>
    <div id="outSprite" class="output"></div>
    <div id="outMoves" class="output"></div>
    <div id="outData" class="output"></div>
</div>
    
<Card style={{ width: '18rem' }}>
    <Card.Img variant="top" src="holder.js/100px180?text=Image cap" />
    <Card.Body>
      <Card.Title>Card Title</Card.Title>
      <Card.Text>
        Some quick example text to build on the card title and make up the bulk of
        the card's content.
      </Card.Text>
    </Card.Body>
    <ListGroup className="list-group-flush">
      <ListGroupItem>Cras justo odio</ListGroupItem>
      <ListGroupItem>Dapibus ac facilisis in</ListGroupItem>
      <ListGroupItem>Vestibulum at eros</ListGroupItem>
    </ListGroup>
    <Card.Body>
      <Card.Link href="#">Card Link</Card.Link>
      <Card.Link href="#">Another Link</Card.Link>
    </Card.Body>
  </Card>
</body>


<script>
//im trying to make the pokemon card with this!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
// document.getElementById("pw")
//     .addEventListener("keyup", function(event) {
//     event.preventDefault();
//     if (event.keyCode === 13) {
//         document.getElementById("myButton").click();
//     }
// });

// function buttonCode()
// {
//   alert("Button code executed.");
// }
//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

function getPokeData() {

//call helper method to get specified URL for API searching
const daURL = setPokemonURL();

var limits = checkPokeGen();


//axios call using the URL created in setPokemonURL()
axios(
{
    method: 'get',
    url: daURL
}
)
.then(function (response) {
    var id = response.data.id; //ID number of the pokemon

    //if the pokemon ID is out of the limit range, exit early and alert the user of the error.
    if (id < limits[0] || id > limits[1]) {
        alert("Your Pokemon is outside the selected generation!");
        return;
    }

    var name = response.data.name; //name of the pokemon
    let types = response.data.types.map(pokemon => {
        return pokemon.type.name;
    });
    types = types.join("/"); //if the pokemon has multiple typings, join with a "/"

    //pull move data and output first 4 moves available 
    let moves = response.data.moves.map(pokeMoves => {
        return pokeMoves.move.name;
    });
    moves = moves.join("|");
    var moveList = moves.split("|");
    moves = "";
    for (let i = 0; i < 4; i++) {
        if (i != 3) {
            moves += moveList[i] + " | ";
        }
        else {
            moves += moveList[i];
        }
    }

    //alert(moveList[0] + " | " + moveList[1]);

    var sprite = response.data.sprites.front_default; //link the to sprite image
    var height = response.data.height; //height of pokemon
    var weight = response.data.weight; //weight of pokemon


    //write the data back to the original html page

    //create tags first
    const tagP1 = document.createElement("p"); //name
    const tagP2 = document.createElement("p"); //id
    const tagP3 = document.createElement("p"); //type(s)
    const tagP4 = document.createElement("p"); //moves
    const tagP5 = document.createElement("p"); //info
    const tagImg = document.createElement("img"); //sprite

    //get every output div
    var nameDiv = document.getElementById("outName");
    var idDiv = document.getElementById("outID");
    var typeDiv = document.getElementById("outType");
    var spriteDiv = document.getElementById("outSprite");
    var moveDiv = document.getElementById("outMoves");
    var dataDiv = document.getElementById("outData")

    //clear out the output divs
    nameDiv.innerHTML = "";
    idDiv.innerHTML = "";
    typeDiv.innerHTML = "";
    spriteDiv.innerHTML = "";
    moveDiv.innerHTML = "";
    dataDiv.innerHTML = "";

    //use the created tags to add output to the original HTML page
    tagP1.innerHTML = "Pokemon Name: " + name;
    nameDiv.appendChild(tagP1);

    //outDiv.appendChild(tagBR);

    tagP2.innerHTML = "Pokemon ID: " + id;
    idDiv.appendChild(tagP2);

    tagP3.innerHTML = "Pokemon Type(s): " + types;
    typeDiv.appendChild(tagP3);

    //outDiv.appendChild(tagBR);

    tagImg.src = sprite;
    spriteDiv.appendChild(tagImg);

    //outDiv.appendChild(tagBR);

    tagP4.innerHTML = "Moves: " + moves;
    moveDiv.appendChild(tagP4);

    tagP5.innerHTML = "Height: " + height + " decimetres | Weight: " + weight + " hectograms";
    dataDiv.appendChild(tagP5);
}
)
.catch(function (error) {
    console.log("Error during AXIOS call! Please try again later.");
    alert("Error during AXIOS call! Please make sure you ensure your input was valid");
})

} //end getPokeData



//helper function for getPokeData; sets up the proper URL for axios call
function setPokemonURL() {
const input = new String(document.getElementById("pokemon").value);
const url = "https://pokeapi.co/api/v2/pokemon/".concat(input.trim(), "/");

return url;
} //end setPokemonURL



//helper function for getPokeData; validates generation data from user
function checkPokeGen() {
var limits = new Array();
switch (document.getElementById("gen").value) {
    case "none":
        limits[0] = 1;
        limits[1] = 721;
        break;
    case "gen1":
        limits[0] = 1;
        limits[1] = 151;
        break;
    case "gen2":
        limits[0] = 152;
        limits[1] = 251;
        break;
    case "gen3":
        limits[0] = 252;
        limits[1] = 386;
        break;
    case "gen4":
        limits[0] = 387;
        limits[1] = 493;
        break;
    case "gen5":
        limits[0] = 494;
        limits[1] = 649;
        break;
    case "gen6":
        limits[0] = 650;
        limits[1] = 721;
        break;
}

return limits;
} //end checkPokeGen


//*****************************************************************************************
//*              Method for getting default data on initial page load/reload              *
//*              98% copy of the existing getPokeData() method                            *
//*****************************************************************************************

function getDefaultPokeData() {
axios(
    {
        method: 'get',
        url: "https://pokeapi.co/api/v2/pokemon/pikachu/"
    }
)
    .then(function (response) {
        var id = response.data.id; //ID number of the pokemon

        var name = response.data.name; //name of the pokemon
        let types = response.data.types.map(pokemon => {
            return pokemon.type.name;
        });
        types = types.join("/"); //if the pokemon has multiple typings, join with a "/"

        //pull move data and output first 4 moves available 
        let moves = response.data.moves.map(pokeMoves => {
            return pokeMoves.move.name;
        });
        moves = moves.join("|");
        var moveList = moves.split("|");
        moves = "";
        for (let i = 0; i < 4; i++) {
            if (i != 3) {
                moves += moveList[i] + " | ";
            }
            else {
                moves += moveList[i];
            }
        }
        //alert(moves);

        var sprite = response.data.sprites.front_default; //link the to sprite image
        var height = response.data.height; //height of pokemon
        var weight = response.data.weight; //weight of pokemon


        //write the data back to the original html page

        //create tags first
        const tagP1 = document.createElement("p"); //name
        const tagP2 = document.createElement("p"); //id
        const tagP3 = document.createElement("p"); //type(s)
        const tagP4 = document.createElement("p"); //moves
        const tagP5 = document.createElement("p"); //info
        const tagImg = document.createElement("img"); //sprite

        //get every output div
        var nameDiv = document.getElementById("outName");
        var idDiv = document.getElementById("outID");
        var typeDiv = document.getElementById("outType");
        var spriteDiv = document.getElementById("outSprite");
        var moveDiv = document.getElementById("outMoves");
        var dataDiv = document.getElementById("outData")

        //clear out the output divs
        nameDiv.innerHTML = "";
        idDiv.innerHTML = "";
        typeDiv.innerHTML = "";
        spriteDiv.innerHTML = "";
        moveDiv.innerHTML = "";
        dataDiv.innerHTML = "";

        //use the created tags to add output to the original HTML page
        tagP1.innerHTML = "Pokemon Name: " + name;
        nameDiv.appendChild(tagP1);

        //outDiv.appendChild(tagBR);

        tagP2.innerHTML = "Pokemon ID: " + id;
        idDiv.appendChild(tagP2);

        tagP3.innerHTML = "Pokemon Type(s): " + types;
        typeDiv.appendChild(tagP3);

        //outDiv.appendChild(tagBR);

        tagImg.src = sprite;
        spriteDiv.appendChild(tagImg);

        //outDiv.appendChild(tagBR);

        tagP4.innerHTML = "Moves: " + moves;
        moveDiv.appendChild(tagP4);

        tagP5.innerHTML = "Height: " + height + " decimetres | Weight: " + weight + " hectograms";
        dataDiv.appendChild(tagP5);
    }
    )
    .catch(function (error) {
        console.log("Error during AXIOS call! Please try again later.");
        alert("Error during AXIOS call! Please make sure you ensure your input was valid");
    })

} //end getDefaultPokeData
    </script>
    <style>
        body {
          margin: 0;
          box-sizing: border-box;
          background-size: cover;
          background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: 0% 50%; 
    
          background-image: url(pokemon.png)
          
        }
        form{      
      color: white;
          }
    
        .container {
          height: 100vh;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
          background: linear-gradient(to right, rgba(0, 0, 0, .5), rgba(0, 0, 0, .1));
          background-size: cover;
          background-position: center;
          background-repeat: no-repeat;
        }
    
        h1 {
          font-size: 5rem;
          color: #fff;
          border:white 5px solid;
        width: 100%;
        height: 100px;
        }
    
        h2 {
          font-size: 2rem;
          color: #fff;
          text-transform: uppercase;
          font-weight: 700;
          margin-bottom: 1rem;
        }
    
        p {
          font-size: 1.5rem;
          color: #fff;
          font-weight: 700;
          margin-bottom: 1rem;
        }
    
        a {
          padding: 15px 20px;
          background: #ff0101;
          font-size: 1rem;
          text-decoration: none;
          color: #333333;
          border-radius: .25rem;
          box-shadow: 0 0 20px rgba(255, 255, 255, 0.808)
        }
        table {
      font-family: arial, sans-serif;
      border-collapse: collapse;
      width: 100%;
      color: white;
    }
    
    
    td, th {
      border: 1px solid #dddddd;
      text-align: left;
      padding: 8px;
    }
    .output{
        color: red;
    }
    .outName{
width: 100px;
height: 100px;
line-height: 100px;
border: 1px solid black;
position: absolute;
text-align: center;             
background: rgb(0, 150, 0);
background: rgba(0, 150, 0, .5);
}
    
      </style>

</html>